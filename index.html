<!DOCTYPE html>

<html>
    <head>
        <link rel="apple-touch-icon" sizes="57x57" href="icon/apple-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="icon/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="icon/apple-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="icon/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="icon/apple-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="icon/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="icon/apple-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="icon/apple-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="icon/apple-icon-180x180.png">
        <link rel="icon" type="image/png" sizes="192x192"  href="icon/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="96x96" href="icon/favicon-96x96.png">
        <link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
        <link rel="manifest" href="icon/manifest.json">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="icon/ms-icon-144x144.png">
        <meta name="theme-color" content="#ffffff">
        <meta charset="utf-8">
        <title>
            MyChessOpening
        </title>
    </head>
    <body>
        <header id="header">
            <h1>MyChessOpening</h1>
            <div id="profile">

            </div>
            <nav>
                <ul>
                    <li>Home</li>
                    <li><a href="test/">Test</a></li>
                    <li><a href="openings/">Openings</a></li>
                    <li><a href="about/">About</a></li>
                </ul>
            </nav>
        </header>
        
        <script>
            function redirecionar(){
                location.href = "test/"
            }
        </script>

        <h2>
            Openings really matter
        </h2>
        <p>
            Despite what Bobby Fischer said about the large opening theory we have nowadays, openings 
            play a crucial role in the game: It sets how the middle-game - the most important part of the game -
            is going to be. 
        </p>
        <p>
            So you better be prepared to play the openings that lead to a middle-game position where you are more comfortable
            with, and suits your playing style. 
        </p>
        <p>
            In order to help you in this task, we've created an AI that analyses your online games and finds what is the best 
            opening for you!
        </p>

        <button onclick="redirecionar()">Take the test!</button>

        <footer>
            <ul>
                <li>
                    <a href="libraries/">Third-part libraries</a>
                </li>
                <li>
                    <a href="https://github.com/gabrielcoffee/My-Chess-Opening">
                        Source code
                    </a>
                </li>
            </ul>
        </footer>

        <script>
            // i got this usefull function from https://www.w3schools.com/js/js_cookies.asp
            function getCookie(cname) {
                let name = cname + "=";
                let decodedCookie = decodeURIComponent(document.cookie);
                let ca = decodedCookie.split(';');
                for(let i = 0; i <ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                    }
                }
                return "";
            }
            function onclicklogin(){
                location.href="login/";
            }

            function onclickregister(){
                location.href="register/";
            }

            var cookies = document.cookie;
            if (cookies.indexOf("loginId") < 0){
                var loginButtons = document.getElementById("profile");
                var loginButton = document.createElement("button");
                loginButton.setAttribute("onclick", "onclicklogin()");
                loginButton.innerHTML="Login";
                loginButtons.appendChild(loginButton);
                var registerButton = document.createElement("button");
                registerButton.setAttribute("onclick", "onclickregister()");
                registerButton.innerHTML="Register";
                loginButtons.appendChild(registerButton);
            }
            else{
                var loginId = getCookie("loginId");
                var data = new FormData();
                data.append("loginId", loginId);
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "https://mychessopening.com/api/login/checkIfLogged.php", true);
                xhr.onload = function (){
                    var responseObj = JSON.parse(xhr.response);
                    var isLogged = responseObj.logged;
                    if (isLogged){  
                        var username = responseObj.username;
                        var profile = document.getElementById("profile");
                        
                    }
                    else{
                        document.cookie = "loginId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                        var loginButtons = document.getElementById("profile");
                        var loginButton = document.createElement("button");
                        loginButton.setAttribute("onclick", "onclicklogin()");
                        loginButton.innerHTML="Login";
                        loginButtons.appendChild(loginButton);
                        var registerButton = document.createElement("button");
                        registerButton.setAttribute("onclick", "onclickregister()");
                        registerButton.innerHTML="Register";
                        loginButtons.appendChild(registerButton);  
                    }
                }
                xhr.send(data); 
            }  
        </script>
    </body>
</html>
